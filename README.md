# Provision an EKS Cluster(WIP)

- 모든 리소스를 테라폼으로 설정할 수 있도록 하기

## versions
- terraform version : 1.11.1
- k8s : 1.32

## Architecture
```
                    +----------------------+
                    |    Internet Gateway  |
                    +----------------------+
                              |
                    +----------------------+
                    |        ALB           |
                    +----------------------+
                        |            |
              +----------------+  +----------------+
              | Public Subnet  |  | Public Subnet  |
              |  10.xx.0.0/24  |  |  10.xx.1.0/24  |
              +----------------+  +----------------+
                        |            |
               +----------------+  +----------------+
               |   NAT Gateway  |  |   NAT Gateway  |
               +----------------+  +----------------+
                        |            |
               +----------------+  +----------------+
               | Private Subnet |  | Private Subnet |
               |  10.xx.xx.0/24 |  |  10.xx.xx.0/24 |
               +----------------+  +----------------+
                        |            |
        +---------------+            +---------------+
        |   Node (AZ1)  |            |   Node (AZ2)  |
        +---------------+            +---------------+
                |                           |
            +---------+                +---------+
            |  Pod    |                |  Pod    |
            +---------+                +---------+
                |                           |
            +---------------------------------------+
            |            Pull Image from            |
            |            ECR Registry               |
            +---------------------------------------+
```

## 1. VPC 설정
- [x] EKS CIDR 설정
- [x] Public Subnet 설정
- [x] Private Subnet 설정
- [ ] NAT Gateway 설정 (각 AZ별)
- [ ] 인터넷 게이트웨이 연결

## 2. EKS 클러스터 설정
- [x] EKS 클러스터 생성
- [x] 노드 그룹 설정 (각 AZ별 1개 노드)
- [ ] IAM 역할 및 정책 설정 (EKS와 연결된 권한 설정)

## 3. 네트워크 설정
- [x] ALB (애플리케이션 로드 밸런서) 설정
- [ ] ALB와 Public Subnet 연결
- [ ] Private Subnet에서 NAT Gateway 통해 외부 통신 설정

## 4. Kubernetes 리소스 설정
- [x] ECR 레지스트리 설정
- [x] ECR 이미지 푸시
- [x] Deployment, Service 등 Kubernetes 리소스 정의
- [x] 각 노드에서 ECR에서 이미지 풀링 설정

## 5. 보안 및 접근 설정
- [ ] 보안 그룹 설정 (ALB, EC2, Pod 접근)
- [ ] Network ACL 설정 (서브넷별 접근 제어)

## 6. 모니터링 및 로깅
- [ ] CloudWatch 로그 설정
- [ ] CloudWatch Alarms 설정
- [ ] Prometheus, Grafana 등 모니터링 도구 설정

## 7. 테스트 및 검증
- [ ] 애플리케이션 배포 및 테스트
- [ ] ECR에서 이미지를 정상적으로 풀링하는지 확인
- [ ] 외부 통신 테스트 (NAT Gateway, 인터넷 연결)
- [ ] 로드 밸런서 트래픽 처리 테스트

## 8. 문서화
- [x] 아키텍처 다이어그램 작성
- [ ] 구성 및 배포 절차 문서화
- [ ] 트러블슈팅 가이드 작성
